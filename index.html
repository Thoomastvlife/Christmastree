<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è–èª•å¿«æ¨‚ - èºæ—‹è–èª•æ¨¹</title>
    <style>
        /* å…¨å±€é‡ç½®+æ‰‹æ©Ÿé©é… */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            background-color: #000;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            perspective: 800px;
            font-family: 'Microsoft JhengHei', sans-serif;
            touch-action: manipulation;
            opacity: 0;
            animation: fadeIn 1s ease forwards;
            /* å…¨å±€ç¡¬ä»¶åŠ é€ŸåŸºç¡€ */
            transform: translateZ(0);
        }

        /* éŸ³æ¨‚æŒ‰éˆ• */
        #music-btn {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: #fff;
            border: 2px solid #FFD700;
            padding: 6px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: clamp(12px, 2vw, 14px);
            z-index: 999;
            transition: all 0.3s ease;
        }
        #music-btn:hover {
            background: rgba(255, 215, 0, 0.2);
        }

        /* è–èª•æ¨¹å®¹å™¨ - æ ¸å¿ƒæµç•…åŒ–ä¼˜åŒ– */
        .tree-container {
            position: relative;
            width: clamp(200px, 50vw, 300px);
            height: clamp(250px, 60vw, 350px);
            transform-style: preserve-3d;
            transform-origin: center center;
            /* 1. å¼€å¯ç¡¬ä»¶åŠ é€Ÿ + ä¼˜åŒ–åŠ¨ç”» */
            transform: translateZ(0);
            will-change: transform; /* å‘Šè¯‰æµè§ˆå™¨æå‰ä¼˜åŒ– */
            backface-visibility: hidden; /* éšè—èƒŒé¢ï¼Œå‡å°‘æ¸²æŸ“ */
            /* 2. ä¼˜åŒ–æ—‹è½¬åŠ¨ç”»ï¼šé™ä½è½¬é€Ÿ+æ›´å¹³æ»‘ï¼ˆçº¿æ€§åŠ¨ç”»ä¹Ÿå¯åŠ å°å¹…åº¦ç¼“åŠ¨ï¼‰ */
            animation: rotateTree 25s infinite linear; 
            margin: 20px 0;
        }

        /* ä¼˜åŒ–æ—‹è½¬åŠ¨ç”»ï¼šé™ä½è§’é€Ÿåº¦ï¼Œè§†è§‰æ›´æµç•… */
        @keyframes rotateTree {
            0% { transform: rotateY(0deg) translateZ(0); }
            100% { transform: rotateY(360deg) translateZ(0); }
        }

        /* èºæ—‹å…‰å¸¦ - æµç•…åŒ–æ ¸å¿ƒä¼˜åŒ– */
        .dot {
            position: absolute;
            width: clamp(4px, 1vw, 6px);
            height: clamp(4px, 1vw, 6px);
            border-radius: 50%;
            /* 1. ä¼˜åŒ–å…‰æ™•ï¼šæ›´æŸ”å’Œçš„é˜´å½±ï¼Œå‡å°‘æ¸²æŸ“è´Ÿæ‹… */
            box-shadow: 0 0 clamp(5px, 1.5vw, 7px) clamp(1px, 0.3vw, 1.5px) currentColor;
            opacity: 0.95; /* æé«˜ä¸é€æ˜åº¦ï¼Œå‡å°‘é—ªçƒæ„Ÿ */
            left: 50%;
            top: 0;
            /* 2. ç¡¬ä»¶åŠ é€Ÿ + å‡å°‘é‡ç»˜ */
            transform: translateX(-50%) translateZ(0);
            will-change: transform;
            backface-visibility: hidden;
            /* 3. å–æ¶ˆä¸å¿…è¦çš„è¿‡æ¸¡ï¼Œé¿å…å†²çª */
            transition: none;
        }

        /* æ¨¹é ‚æ˜Ÿæ˜Ÿ */
        .star {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%) rotateY(0deg) translateZ(0);
            color: #FFD700;
            font-size: clamp(24px, 5vw, 30px);
            text-shadow: 0 0 clamp(8px, 2vw, 10px) #FFD700;
            z-index: 10;
            animation: twinkle 2s infinite alternate;
            will-change: opacity, text-shadow;
        }

        @keyframes twinkle {
            from { opacity: 0.8; }
            to { opacity: 1; text-shadow: 0 0 15px #FFD700; }
        }

        /* æ–‡å­—å€åŸŸ */
        .message {
            text-align: center;
            margin-top: 10px;
            pointer-events: none;
            z-index: 10;
        }
        .message h1 {
            font-size: clamp(1.5em, 5vw, 2em);
            color: #FF4D4D;
            text-shadow: 0 0 clamp(6px, 2vw, 8px) #FF4D4D;
            margin-bottom: 5px;
            animation: pulse 3s infinite alternate;
        }
        .message p {
            font-size: clamp(0.8em, 3vw, 1em);
            color: #fff;
            text-shadow: 0 0 clamp(4px, 1.5vw, 6px) #fff;
            letter-spacing: 1px;
        }

        @keyframes pulse {
            from { transform: scale(1); }
            to { transform: scale(1.05); }
        }

        /* é›ªèŠ±æ•ˆæœ */
        .snow {
            position: absolute;
            top: -10px;
            color: #fff;
            font-size: clamp(10px, 2vw, 12px);
            opacity: 0.7;
            pointer-events: none;
            animation: fall linear forwards, sway 3s infinite alternate;
        }

        @keyframes fall {
            to { transform: translateY(110vh); }
        }

        @keyframes sway {
            from { transform: translateX(0px); }
            to { transform: translateX(10px); }
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- éŸ³æ¨‚æ§åˆ¶ -->
    <button id="music-btn">ğŸ”‡ æ’­æ”¾éŸ³æ¨‚</button>
    <audio id="bg-music" loop preload="auto">
        <source src="tree.mp3" type="audio/mpeg">
        ä½ çš„ç€è¦½å™¨ä¸æ”¯æ´éŸ³é »æ’­æ”¾
    </audio>

    <!-- è–èª•æ¨¹ -->
    <div class="tree-container" id="tree">
        <div class="star">â˜…</div>
    </div>

    <!-- æ–‡å­— -->
    <div class="message">
        <h1>Merry Christmas</h1>
        <p>ç¥ä½ è–èª•å¿«æ¨‚ï¼Œå¹¸ç¦æ°¸é </p>
    </div>

    <script>
        // éŸ³æ¨‚æ§åˆ¶ï¼ˆä¿ç•™åŸæœ‰é€»è¾‘ï¼‰
        const audio = document.getElementById('bg-music');
        const musicBtn = document.getElementById('music-btn');
        let isMusicOn = false;
        let musicInitiated = false;
        audio.volume = 0.4;

        function playMusic() {
            if (musicInitiated) return;
            musicInitiated = true;
            
            audio.play().then(() => {
                isMusicOn = true;
                musicBtn.textContent = "ğŸ”Š é—œé–‰éŸ³æ¨‚";
            }).catch((err) => {
                console.log("éŸ³é »æ’­æ”¾æç¤ºï¼š", err);
                musicBtn.textContent = "ğŸ”‡ é»æ“Šæ‰‹å‹•æ’­æ”¾";
                musicInitiated = false;
            });
        }

        document.addEventListener('click', initMusic);
        document.addEventListener('touchstart', initMusic);

        function initMusic() {
            if (!isMusicOn && !musicInitiated) {
                playMusic();
            }
        }

        musicBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            if (isMusicOn) {
                audio.pause();
                isMusicOn = false;
                musicBtn.textContent = "ğŸ”‡ æ’­æ”¾éŸ³æ¨‚";
            } else {
                playMusic();
            }
        });

        // ç”Ÿæˆèºæ—‹è–èª•æ¨¹ - ä¼˜åŒ–å…‰å¸¦æµç•…åº¦
        const tree = document.getElementById('tree');
        const dotCount = 220; // å¢åŠ å…‰ç‚¹æ•°é‡ï¼Œå‡å°‘"æ–­å±‚"ï¼ˆ220ä¸ªæ›´å¯†é›†ï¼‰
        const colors = ['#FF4D4D', '#00FF00', '#FFFFFF', '#FFD700', '#00BFFF'];

        // ä¼˜åŒ–èºæ—‹ç®—æ³•ï¼šæ›´å¹³æ»‘çš„åæ ‡æ’å€¼
        for (let i = 0; i < dotCount; i++) {
            const dot = document.createElement('div');
            dot.className = 'dot';
            
            // 1. ä¼˜åŒ–é«˜åº¦/åŠå¾„/è§’åº¦å‚æ•°ï¼šæ›´çº¿æ€§çš„å¢é•¿ï¼Œå‡å°‘çªå˜
            const progress = i / dotCount; // 0~1çš„è¿›åº¦å€¼ï¼Œè®©å¢é•¿æ›´å‡åŒ€
            const height = progress * 380; // å›ºå®šæ€»é«˜åº¦ï¼ŒæŒ‰è¿›åº¦åˆ†é…
            const radius = progress * 120; // å›ºå®šæ€»åŠå¾„ï¼Œé¿å…åæœŸå¢é•¿è¿‡å¿«
            const angle = i * 0.28; // å¾®è°ƒè§’åº¦ï¼Œè®©èºæ—‹æ›´ç´§å¯†
            
            // 2. è®¡ç®—3Dåæ ‡ï¼šç”¨Math.cos/sinçš„é«˜ç²¾åº¦å€¼
            const x = Math.cos(angle) * radius;
            const z = Math.sin(angle) * radius;
            
            // 3. é¢œè‰²ä¼˜åŒ–ï¼šç›¸é‚»å…‰ç‚¹é¢œè‰²è¿‡æ¸¡æ›´è‡ªç„¶ï¼ˆé¿å…è·³è‰²ï¼‰
            const colorIndex = Math.floor((i / dotCount) * colors.length);
            dot.style.color = colors[colorIndex % colors.length];
            dot.style.background = dot.style.color;
            
            // 4. ä¼˜åŒ–3Då˜æ¢ï¼šåˆå¹¶transformï¼Œå‡å°‘æ¸²æŸ“æ­¥éª¤
            dot.style.transform = `translate3d(${x.toFixed(2)}px, ${height.toFixed(2)}px, ${z.toFixed(2)}px)`;
            
            tree.appendChild(dot);
        }

        // é›ªèŠ±ç”Ÿæˆï¼ˆä¿ç•™åŸæœ‰é€»è¾‘ï¼‰
        function createSnow() {
            const snowCount = document.querySelectorAll('.snow').length;
            if (snowCount > 50) return;
            
            const snow = document.createElement('div');
            snow.className = 'snow';
            snow.textContent = ['â„', 'â…', 'â†'][Math.floor(Math.random() * 3)];
            snow.style.left = Math.random() * 100 + 'vw';
            snow.style.animationDuration = Math.random() * 4 + 3 + 's';
            snow.style.opacity = Math.random() * 0.5 + 0.3;
            snow.style.animationDelay = Math.random() * 2 + 's';
            
            document.body.appendChild(snow);
            
            setTimeout(() => {
                if (snow.parentNode) {
                    snow.remove();
                }
            }, 7000);
        }

        setInterval(createSnow, 300);

        // è§†çª—å¤§å°å˜åŒ–ä¼˜åŒ–
        window.addEventListener('resize', () => {
            // é¿å…resizeæ—¶é‡ç»˜åœ£è¯æ ‘ï¼Œä¿æŒæµç•…
            tree.style.willChange = 'auto';
            setTimeout(() => {
                tree.style.willChange = 'transform';
            }, 100);
        });

        // é¡µé¢ç„¦ç‚¹ä¼˜åŒ–
        window.addEventListener('blur', () => {
            if (isMusicOn) audio.pause();
            // åå°æ—¶é™ä½åŠ¨ç”»é€Ÿåº¦ï¼Œå‡å°‘æ€§èƒ½æ¶ˆè€—
            tree.style.animationDuration = '60s';
        });

        window.addEventListener('focus', () => {
            if (isMusicOn) {
                musicBtn.textContent = "ğŸ”‡ é»æ“Šæ¢å¾©éŸ³æ¨‚";
                isMusicOn = false;
            }
            // å‰å°æ¢å¤æ­£å¸¸é€Ÿåº¦
            tree.style.animationDuration = '25s';
        });
    </script>
</body>
</html>
